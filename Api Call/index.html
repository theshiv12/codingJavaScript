<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Generating a downloadable CSV file in the browser.
    </title>
  </head>
  <body>
    <h1>Generating a downloadable CSV file in the browser.</h1>
    
    <div onclick="abc()"><a href=" URL.createObjectURL(csvBlob)" id="a2" download="file.csv">Download</a></div>
    <a href="https://www.w3schools.com">Visit W3Schools.com!</a>
   <br> <a id="a3" download="file.csv">id sort</a>
    
    <br><a id="a4" download="file.csv">name sort</a>   
   
    <script>
        
        // const data = [
        //     {
        //         "model": "Samsung S7",
        //         "chargers": "55",
        //         "cases": "56",
        //         "earphones": "57",
        //         "scratched": "2"
        //     },
        //     {
        //         "model": "Pixel XL",
        //         "chargers": "77",
        //         "cases": "78",
        //         "earphones": "79",
        //         "scratched": "4"
        //     },
        //     {
        //         "model": "iPhone 7",
        //         "chargers": "88",
        //         "cases": "89",
        //         "earphones": "90",
        //         "scratched": "6"
        //     }
        // ];
        function campare(a, b) {
             const bandA = a.username.toUpperCase();
             const bandB = b.username.toUpperCase();
            if(bandA>bandB)
                campare=1;
            else if(bandA<bandB)
                campare=-1;
            
            return campare;
        }


        function campare(a, b) {
             const bandA = a.name.toUpperCase();
             const bandB = b.name.toUpperCase();
            if(bandA>bandB)
                campare=1;
            else if(bandA<bandB)
                campare=-1;
            
            return campare;
        }

 async       function abc(){

       await data = fetch('https://jsonplaceholder.typicode.com/users')
  .then(response => response.json())
  .then(data => 
  { 
    console.log(data);
    let sortData = data.sort(campare);
     
    // get keys as array
    
    const keys = Object.keys(sortData[0]);
    
          
    const commaSeparatedString = [keys.join(",") , data.map(row => keys.map(key => row[key]).join(",")).join("\n")].join("\n")
         
        const csvBlob = new Blob([commaSeparatedString])
    
        const a2 = document.getElementById("a2")
    
        a2.href = URL.createObjectURL(csvBlob)
  }
  );
}
        // // get keys as array
        // const keys = Object.keys(data[0]);
        
        // const commaSeparatedString = [keys.join(",") , data.map(row => keys.map(key => row[key]).join(",")).join("\n")].join("\n")
    
        // const csvBlob = new Blob([commaSeparatedString])
    
        // const a2 = document.getElementById("a2")
    
        // a2.href = URL.createObjectURL(csvBlob)
    
    </script>
  </body>
</html>